(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[      8228,        201]
NotebookOptionsPosition[      7829,        182]
NotebookOutlinePosition[      8180,        198]
CellTagsIndexPosition[      8137,        195]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"collatz", "[", "N_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"n", "=", "N"}], "}"}], ",", 
    RowBox[{
     RowBox[{"Reap", "[", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Sow", "[", "n", "]"}], ">", "1"}], ",", 
        RowBox[{"n", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"EvenQ", "[", "n", "]"}], ",", 
           RowBox[{"n", "/", "2"}], ",", 
           RowBox[{
            RowBox[{"3", "n"}], "+", "1"}]}], "]"}]}]}], "]"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.649842617250703*^9, 3.649842627628962*^9}, {
  3.649842672657639*^9, 3.649842693904571*^9}, {3.64984274448503*^9, 
  3.649842878409894*^9}, {3.649843214531849*^9, 3.6498432149237347`*^9}, {
  3.6498510902509203`*^9, 3.649851091031934*^9}}],

Cell[BoxData[
 RowBox[{"img", "=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"nmax", "=", 
        RowBox[{"10", "^", "10"}]}], ",", 
       RowBox[{"nsample", "=", "4000"}], ",", 
       RowBox[{"angle", "=", "25."}], ",", 
       RowBox[{"seed", "=", "23234"}]}], "}"}], ",", 
     RowBox[{"Graphics", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"ColorData", "[", "\"\<ValentineTones\>\"", "]"}], "[", 
            RowBox[{".3", "+", 
             RowBox[{".7", 
              RowBox[{
               RowBox[{"Mod", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"nsample", "-", "1"}]}], "]"}], "/", "nsample"}]}]}],
             "]"}], ",", 
           RowBox[{"Thickness", "[", 
            RowBox[{".001", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"#", "/", "nmax"}]}], ")"}], "^", "5"}]}], "]"}], ",", 
           RowBox[{"Opacity", "[", 
            RowBox[{".5", 
             RowBox[{"(", 
              RowBox[{"#", "/", "nmax"}], ")"}]}], "]"}], ",", 
           RowBox[{"Line", "@", 
            RowBox[{"AnglePath", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"1", "/", 
                   RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"#", "^", ".1"}]}], ")"}]}], ",", 
                  RowBox[{"angle", " ", "Degree", " ", 
                   RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Log", "[", "6", "]"}], "/", 
                    RowBox[{"Log", "[", "2", "]"}]}], 
                    RowBox[{"Mod", "[", 
                    RowBox[{"#", ",", "2"}], "]"}]}]}], ")"}]}]}], "}"}], 
                "&"}], ")"}], "/@", " ", 
              RowBox[{"Reverse", "@", 
               RowBox[{"collatz", "[", "#", "]"}]}]}], "]"}]}]}], "}"}], 
         "&"}], ")"}], "/@", 
       RowBox[{"Range", "[", 
        RowBox[{"seed", ",", "nmax", ",", 
         RowBox[{"nmax", "/", "nsample"}]}], "]"}]}], "]"}]}], "]"}], "//", 
   RowBox[{
    RowBox[{"Show", "[", 
     RowBox[{"#", ",", 
      RowBox[{"Background", "\[Rule]", "Black"}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}], "&"}]}]}]], "Input",\

 CellChangeTimes->{{3.6498437008904247`*^9, 3.6498437039673967`*^9}, {
   3.64984379439288*^9, 3.649843796509984*^9}, {3.649843957855719*^9, 
   3.6498439624886293`*^9}, {3.649843993340065*^9, 3.649844034340732*^9}, {
   3.64984406598658*^9, 3.64984407768159*^9}, {3.649844163604907*^9, 
   3.6498442123010473`*^9}, {3.6498442521111183`*^9, 3.649844271695984*^9}, {
   3.649844326082505*^9, 3.6498443804775543`*^9}, {3.649844414437435*^9, 
   3.649844529844805*^9}, {3.6498445768900642`*^9, 3.649844638456315*^9}, {
   3.649844731370686*^9, 3.649844990348962*^9}, {3.649845041109404*^9, 
   3.6498450745001383`*^9}, {3.649845105710038*^9, 3.649845132111977*^9}, {
   3.649845231170889*^9, 3.649845325743499*^9}, {3.649845444504897*^9, 
   3.649845446695738*^9}, {3.649845511444003*^9, 3.649845545549391*^9}, {
   3.6498456000878363`*^9, 3.649845632061255*^9}, {3.649845674339614*^9, 
   3.6498458257089577`*^9}, {3.649846091273563*^9, 3.649846104977078*^9}, {
   3.649846146304591*^9, 3.649846181294505*^9}, 3.649846287613456*^9, {
   3.649846340754237*^9, 3.649846439166451*^9}, {3.649846474085965*^9, 
   3.649846477085423*^9}, {3.649846559893672*^9, 3.649846608278853*^9}, {
   3.649846652049287*^9, 3.649846653175188*^9}, {3.649846698000049*^9, 
   3.6498467443953114`*^9}, {3.649846817917729*^9, 3.649846819007223*^9}, {
   3.64984721859918*^9, 3.649847219662184*^9}, {3.649847321286747*^9, 
   3.6498473244462547`*^9}, {3.64984739897228*^9, 3.6498474011144047`*^9}, {
   3.649847454280242*^9, 3.649847490693675*^9}, {3.6498475278809137`*^9, 
   3.649847670675653*^9}, {3.649847766463678*^9, 3.64984793324783*^9}, {
   3.6498484238902693`*^9, 3.6498484585300417`*^9}, {3.649848521308721*^9, 
   3.649848553169732*^9}, {3.649848587417964*^9, 3.6498485886903477`*^9}, {
   3.6498486694552507`*^9, 3.6498487174683867`*^9}, {3.649848763879423*^9, 
   3.6498487912353086`*^9}, {3.6498488265098467`*^9, 3.649848840718072*^9}, {
   3.649849024943095*^9, 3.649849118560611*^9}, {3.64984921431489*^9, 
   3.649849294697743*^9}, {3.649849334664609*^9, 3.649849460145412*^9}, {
   3.649849496487506*^9, 3.6498495799108047`*^9}, {3.6498510929046297`*^9, 
   3.6498510930337543`*^9}, {3.6498515433925047`*^9, 3.649851543802834*^9}, {
   3.649851590210589*^9, 3.649851591178503*^9}, {3.649851650345293*^9, 
   3.649851659351151*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\<render.png\>\""}], 
   ",", 
   RowBox[{"Rasterize", "[", 
    RowBox[{"img", ",", "\"\<Image\>\"", ",", 
     RowBox[{"RasterSize", "\[Rule]", "9128"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6498479744217987`*^9, 3.649848012397025*^9}, {
   3.649848097436344*^9, 3.649848101725511*^9}, {3.649848137100871*^9, 
   3.6498481706180468`*^9}, {3.649848215018978*^9, 3.649848233392148*^9}, {
   3.649848310099134*^9, 3.649848326416497*^9}, {3.649848365009697*^9, 
   3.6498483664150553`*^9}, {3.6498484119892263`*^9, 
   3.6498484209627647`*^9}, {3.649848492761004*^9, 3.64984849976696*^9}, {
   3.649848910356043*^9, 3.649848910723145*^9}, 3.649848963590617*^9, {
   3.649851644456184*^9, 3.649851645159823*^9}, {3.64985170977571*^9, 
   3.649851709938919*^9}}],

Cell[BoxData["\<\"/Users/hermann/Documents/sketch/2015-08-29-collatz/render.\
png\"\>"], "Output",
 CellChangeTimes->{
  3.649848017650366*^9, 3.649848178708086*^9, {3.649848323760789*^9, 
   3.6498483334933167`*^9}, 3.6498483786359463`*^9, {3.649848476631674*^9, 
   3.649848510186531*^9}, 3.64984860975955*^9, 3.649848729334709*^9, 
   3.649848812527454*^9, 3.649848869742786*^9, 3.6498489236141644`*^9, 
   3.649848977370166*^9, 3.649849672591659*^9, 3.649851574439323*^9, 
   3.649851621069645*^9, 3.6498517073952*^9, 3.649851746710196*^9}]
}, Open  ]]
},
WindowSize->{646, 715},
WindowMargins->{{4, Automatic}, {0, Automatic}},
FrontEndVersion->"10.2 for Mac OS X x86 (32-bit, 64-bit Kernel) (July 6, \
2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 941, 25, 63, "Input"],
Cell[1502, 47, 4852, 101, 199, "Input"],
Cell[CellGroupData[{
Cell[6379, 152, 887, 17, 46, "Input"],
Cell[7269, 171, 544, 8, 28, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
